<header class="flex items-center justify-between pb-6 border-b border-gray-200 mb-8">
    <div class="flex items-center">
        <button id="sidebar-toggle" class="mr-4 p-2 rounded-full hover:bg-gray-200 text-gray-600 transition">
            <i data-lucide="menu" class="w-6 h-6"></i>
        </button>
        <h1 class="text-3xl font-bold text-gray-800">Gestión de Stock e Insumos</h1>
    </div>
    <span class="text-sm text-gray-500">Módulo: Inventario y Compras</span>
</header>

<div class="flex flex-col lg:flex-row justify-between items-center mb-6 space-y-4 lg:space-y-0 lg:space-x-4">
    <div class="relative w-full lg:w-96">
        <input type="text" id="search-input" placeholder="Buscar por Nombre o SKU..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-red-500 focus:border-red-500 shadow-sm">
        <i data-lucide="search" class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"></i>
    </div>
    
    <div class="flex space-x-4 w-full lg:w-auto">
        <button id="filter-button" class="w-full lg:w-auto flex items-center justify-center px-4 py-2 bg-gray-300 text-gray-800 font-semibold rounded-lg shadow-md hover:bg-gray-400 transition">
            <i data-lucide="filter" class="w-5 h-5 mr-2"></i> Filtros
        </button>
        <button id="btn-add-item" class="w-full lg:w-auto flex items-center justify-center px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 transition">
            <i data-lucide="plus" class="w-5 h-5 mr-2"></i> Agregar Producto
        </button>
        <button id="btn-create-oc" class="w-full lg:w-auto flex items-center justify-center px-6 py-2 color-primary-red text-white font-semibold rounded-lg shadow-md hover:bg-red-700 transition">
            <i data-lucide="shopping-cart" class="w-5 h-5 mr-2"></i> Crear OC
        </button>
    </div>
</div>

<div id="filter-panel" class="bg-white p-6 rounded-xl shadow-lg mb-6 hidden">
    <h3 class="font-bold text-gray-700 mb-4 border-b pb-2">Opciones de Filtrado</h3>
     <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div>
            <label class="block text-sm font-medium text-gray-700">Categoría</label>
            <select id="filter-category" class="w-full mt-1 px-3 py-2 border border-gray-300 rounded-lg shadow-sm"><option value="">Todas</option></select>
        </div>
        <div>
            <label class="block text-sm font-medium text-gray-700">Estado de Stock</label>
            <select class="w-full mt-1 px-3 py-2 border border-gray-300 rounded-lg shadow-sm"><option>Todos</option><option>Stock Crítico</option><option>OK</option></select>
        </div>
    </div>
</div>

<div class="bg-white shadow-xl rounded-xl overflow-hidden">
    <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200">
            <thead class="table-header-bg">
                <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider">SKU</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider">Producto</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider">Categoría</th>
                    <th class="px-6 py-3 text-center text-xs font-medium text-white uppercase tracking-wider">Clase</th>
                    <th class="px-6 py-3 text-right text-xs font-medium text-white uppercase tracking-wider">Precio Unit.</th>
                    <th class="px-6 py-3 text-center text-xs font-medium text-white uppercase tracking-wider">Stock</th>
                    <th class="px-6 py-3 text-center text-xs font-medium text-white uppercase tracking-wider">Mínimo</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider">Estado</th>
                    <th class="px-6 py-3 text-center text-xs font-medium text-white uppercase tracking-wider">Acciones</th>
                </tr>
            </thead>
            <tbody id="inventory-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
    </div>
</div>
<div id="pagination-controls" class="mt-4 p-4"></div>

<div id="modal-definitions" class="hidden">

    <div id="item-modal-content">
        <div class="relative top-10 mx-auto p-5 border w-full max-w-lg shadow-lg rounded-xl bg-white">
            <h3 id="item-modal-title" class="text-xl font-bold mb-4 text-gray-800">Agregar Nuevo Insumo</h3>
            <form id="item-form" class="space-y-4">
                <input type="hidden" id="item-edit-mode" value="false">
                <input type="hidden" id="item-original-sku" value="">

                <div class="relative">
                    <label class="block text-sm font-medium text-gray-700">Proveedores <span class="text-red-500">*</span></label>
                    <input type="text" id="item-provider-search" autocomplete="off" placeholder="Buscar y seleccionar proveedor..." class="form-input w-full mt-1 p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                    <div id="item-provider-list" class="hidden absolute z-[110] w-full bg-white border border-gray-300 rounded-lg shadow-xl max-h-40 overflow-y-auto mt-1"></div>
                    
                    <div id="selected-providers-container" class="flex flex-wrap gap-2 mt-2 min-h-[30px] p-1"></div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">SKU</label>
                    <input type="text" id="item-sku-display" disabled class="form-input w-full mt-1 p-2 bg-gray-200 border border-gray-300 rounded-lg" value="[Generado automáticamente]">
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700">Nombre del Producto <span class="text-red-500">*</span></label>
                    <input type="text" id="item-name" required class="form-input w-full mt-1 p-2 border border-gray-300 rounded-lg">
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Precio Unit. <span class="text-red-500">*</span></label>
                        <input type="number" id="item-price" required step="0.01" min="0" class="form-input w-full mt-1 p-2 border border-gray-300 rounded-lg" placeholder="0.00">
                    </div>
                    <div class="relative">
                        <label class="block text-sm font-medium text-gray-700">Categoría</label>
                        <input type="text" id="item-category-search" disabled placeholder="Seleccione proveedor..." class="form-input w-full mt-1 p-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed" autocomplete="off">
                        <div id="item-category-list" class="hidden absolute z-[100] w-full bg-white border border-gray-300 rounded-lg shadow-xl max-h-40 overflow-y-auto mt-1"></div>
                    </div>
                </div>

                <div class="grid grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Clase ABC</label>
                        <select id="item-abc" class="form-input w-full mt-1 p-2 border border-gray-300 rounded-lg"><option>A</option><option>B</option><option>C</option></select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Stock Inicial</label>
                        <input type="number" id="item-stock" value="0" min="0" class="form-input w-full mt-1 p-2 border border-gray-300 rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Mínimo</label>
                        <input type="number" id="item-min" value="0" min="0" class="form-input w-full mt-1 p-2 border border-gray-300 rounded-lg">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700">Descripción</label>
                    <textarea rows="2" id="item-desc" class="form-input w-full mt-1 p-2 border border-gray-300 rounded-lg"></textarea>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="window.UI.hideModal('item-modal-container')" class="px-4 py-2 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400">Cancelar</button>
                    <button type="submit" class="px-4 py-2 color-primary-red text-white rounded-lg hover:bg-red-700">Guardar Producto</button>
                </div>
            </form>
        </div>
    </div>
    
    <div id="oc-modal-content">
        <div class="relative top-5 mx-auto p-5 border w-full max-w-xl shadow-lg rounded-xl bg-white" style="min-height: 500px;">
            <h3 class="text-xl font-bold mb-4 text-gray-800">Crear Orden de Compra (OC)</h3>
            <form id="oc-form" class="space-y-4">
                <div class="relative">
                    <label class="block text-sm font-medium text-gray-700">Proveedor <span class="text-red-500">*</span></label>
                    <input type="text" id="oc-provider-search" required autocomplete="off" placeholder="Buscar proveedor..." class="form-input w-full mt-1 p-2 border border-gray-300 rounded-lg">
                    <input type="hidden" id="oc-provider-id">
                    <div id="oc-provider-list" class="hidden absolute z-[100] w-full bg-white border border-gray-300 rounded-lg shadow-xl max-h-48 overflow-y-auto mt-1"></div>
                </div>
                
                <div>
                    <h4 class="font-medium text-gray-700 mb-2">Ítems Disponibles</h4>
                    <div class="p-3 border rounded-lg bg-gray-50">
                        <div class="relative flex space-x-3 items-end">
                            
                            <div class="w-[65%] relative">
                                <label class="text-xs text-gray-500 font-bold block mb-1">Producto</label>
                                <input type="text" id="oc-product-search" disabled placeholder="Seleccione proveedor..." autocomplete="off" class="form-input w-full p-2 border border-gray-300 rounded-lg bg-white disabled:bg-gray-200 text-sm">
                                <div id="oc-product-list" class="hidden absolute z-[90] w-full bg-white border border-gray-300 rounded-lg shadow-xl max-h-40 overflow-y-auto mt-1"></div>
                            </div>

                            <div class="w-[20%]">
                                <label class="text-xs text-gray-500 font-bold block mb-1">Cant.</label>
                                <input type="number" id="oc-qty" placeholder="0" class="form-input w-full p-2 border border-gray-300 rounded-lg text-center text-sm">
                            </div>

                            <button type="button" id="btn-add-oc-item" class="w-[15%] h-[38px] bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 flex items-center justify-center shadow-sm transition-colors">
                                <i data-lucide="plus" class="w-5 h-5"></i>
                            </button>
                        </div>
                    </div>
                    
                    <table class="w-full mt-2 text-sm">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="text-left p-2">Producto</th>
                                <th class="text-right p-2">P. Unit</th>
                                <th class="text-right p-2">Cant.</th>
                                <th class="text-right p-2">Total</th>
                                <th class="p-2"></th>
                            </tr>
                        </thead>
                        <tbody id="oc-items-table-body"></tbody>
                        <tfoot class="border-t-2 border-gray-200 font-bold text-gray-700">
                            <tr>
                                <td colspan="3" class="text-right p-2">Subtotal:</td>
                                <td class="text-right p-2" id="oc-display-subtotal">S/ 0.00</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td colspan="3" class="text-right p-2">IGV (18%):</td>
                                <td class="text-right p-2" id="oc-display-igv">S/ 0.00</td>
                                <td></td>
                            </tr>
                            <tr class="text-lg text-red-600">
                                <td colspan="3" class="text-right p-2">TOTAL:</td>
                                <td class="text-right p-2" id="oc-display-total">S/ 0.00</td>
                                <td></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Notas</label>
                    <textarea id="oc-notes" rows="2" class="form-input w-full mt-1 p-2 border border-gray-300 rounded-lg"></textarea>
                </div>
                <div class="flex justify-end space-x-3 pt-4 mt-auto">
                    <button type="button" onclick="window.UI.hideModal('oc-modal-container')" class="px-4 py-2 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400">Cancelar</button>
                    <button type="submit" class="px-4 py-2 color-primary-red text-white rounded-lg hover:bg-red-700">Generar OC</button>
                </div>
            </form>
        </div>
    </div>
</div>